#update some of the names
method <- LD.clump.result.plot$method_vec
method
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
method
kdx <- which(method =="LDpred (hap3)")
kdx
method[kdx] <- "LDpred"
method
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
method
kdx <- which(method =="ME-Bayes (hap3)")
method[kdx] <- "ME-Bayes"
method
kdx <- which(method =="Best EUR PRS")
method[kdx] <- "EUR P+T PRS"
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target ethnic group coefficients"
method
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target coefficients"
kdx <- which(method =="Best EUR SNP + EB coefficients")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
method.fac <- factor(method,
levels = c("P+T",
"LD pred",
"EUR P+T PRS",
"EUR LDpreD PRS",
"Best EUR SNP + target coefficients",
"SNPs in EUR P+T + EB coefficients",
"ME-Bayes",
"2DLD",
"2DLD-EB"))
LD.clump.result.plot$method_vec <- method.fac
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
idx <- which(LD.clump.result$m_vec==1&
LD.clump.result$eth.vec!="SAS")
library(RColorBrewer)
colourCount = length(unique(LD.clump.result$method_vec))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
LD.clump.result.plot <- LD.clump.result[idx,]
jdx <- which(LD.clump.result.plot$method_vec%in%
c("P+T","Best EUR PRS","Best EUR SNP + target coefficients",
"Best EUR SNP + EB","LDpred (hap3)","EUR LDpred (hap3)","ME-Bayes (hap3)","2DLD","2DLD-EB"))
LD.clump.result.plot <- LD.clump.result.plot[jdx,]
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
kdx <- which(method =="LDpred (hap3)")
method[kdx] <- "LDpred"
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
kdx <- which(method =="ME-Bayes (hap3)")
method[kdx] <- "ME-Bayes"
kdx <- which(method =="Best EUR PRS")
method[kdx] <- "EUR P+T PRS"
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target coefficients"
kdx <- which(method =="Best EUR SNP + EB coefficients")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
method.fac <- factor(method,
levels = c("P+T",
"LD pred",
"EUR P+T PRS",
"EUR LDpreD PRS",
"Best EUR SNP + target coefficients",
"SNPs in EUR P+T + EB coefficients",
"ME-Bayes",
"2DLD",
"2DLD-EB"))
LD.clump.result.plot$method_vec <- method.fac
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
LD.clump.result.plot$method_vec
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
kdx <- which(method =="LDpred (hap3)")
method[kdx] <- "LDpred"
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
kdx <- which(method =="ME-Bayes (hap3)")
method[kdx] <- "ME-Bayes"
kdx <- which(method =="Best EUR PRS")
method[kdx] <- "EUR P+T PRS"
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target coefficients"
kdx <- which(method =="Best EUR SNP + EB coefficients")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
method
LD.clump.result.plot <- LD.clump.result.plot[jdx,]
idx <- which(LD.clump.result$m_vec==1&
LD.clump.result$eth.vec!="SAS")
LD.clump.result.plot <- LD.clump.result[idx,]
jdx <- which(LD.clump.result.plot$method_vec%in%
c("P+T","Best EUR PRS","Best EUR SNP + target coefficients",
"Best EUR SNP + EB","LDpred (hap3)","EUR LDpred (hap3)","ME-Bayes (hap3)","2DLD","2DLD-EB"))
LD.clump.result.plot <- LD.clump.result.plot[jdx,]
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
method
kdx <- which(method =="LDpred (hap3)")
method[kdx] <- "LDpred"
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
kdx <- which(method =="ME-Bayes (hap3)")
method[kdx] <- "ME-Bayes"
kdx <- which(method =="Best EUR PRS")
method[kdx] <- "EUR P+T PRS"
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target coefficients"
kdx <- which(method =="Best EUR SNP + EB coefficients")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
method
method.fac <- factor(method,
levels = c("P+T",
"LDpred",
"EUR P+T PRS",
"EUR LDpred PRS",
"Best EUR SNP + target coefficients",
"SNPs in EUR P+T + EB coefficients",
"ME-Bayes",
"2DLD",
"2DLD-EB"))
method.fac
method
method.fac <- factor(method,
levels = c("P+T",
"LDpred",
"EUR P+T PRS",
"EUR LDpred PRS",
"SNPs in EUR P+T + target coefficients",
"SNPs in EUR P+T + EB coefficients",
"ME-Bayes",
"2DLD",
"2DLD-EB"))
method.fac
method
kdx <- which(method =="Best EUR SNP + EB")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
LD.clump.result.plot$method_vec <- method.fac
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
method.fac
method
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
idx <- which(LD.clump.result$m_vec==1&
LD.clump.result$eth.vec!="SAS")
library(RColorBrewer)
LD.clump.result.plot <- LD.clump.result[idx,]
jdx <- which(LD.clump.result.plot$method_vec%in%
c("P+T","Best EUR PRS","Best EUR SNP + target coefficients",
"Best EUR SNP + EB","LDpred (hap3)","EUR LDpred (hap3)","ME-Bayes (hap3)","2DLD","2DLD-EB"))
LD.clump.result.plot <- LD.clump.result.plot[jdx,]
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
kdx <- which(method =="LDpred (hap3)")
method[kdx] <- "LDpred"
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
kdx <- which(method =="ME-Bayes (hap3)")
method[kdx] <- "ME-Bayes"
kdx <- which(method =="Best EUR PRS")
method[kdx] <- "EUR P+T PRS"
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target coefficients"
kdx <- which(method =="Best EUR SNP + EB coefficients")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
method.fac <- factor(method,
levels = c("P+T",
"LDpred",
"EUR P+T PRS",
"EUR LDpred PRS",
"SNPs in EUR P+T + target coefficients",
"SNPs in EUR P+T + EB coefficients",
"ME-Bayes",
"2DLD",
"2DLD-EB"))
LD.clump.result.plot$method_vec <- method.fac
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
idx <- which(LD.clump.result$m_vec==1&
LD.clump.result$eth.vec!="SAS")
library(RColorBrewer)
colourCount = length(unique(LD.clump.result$method_vec))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
LD.clump.result.plot <- LD.clump.result[idx,]
jdx <- which(LD.clump.result.plot$method_vec%in%
c("P+T","Best EUR PRS","Best EUR SNP + target coefficients",
"Best EUR SNP + EB","LDpred (hap3)","EUR LDpred (hap3)","ME-Bayes (hap3)","2DLD","2DLD-EB"))
LD.clump.result.plot <- LD.clump.result.plot[jdx,]
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
LD.clump.result.plot
#update some of the names
method <- as.character(LD.clump.result.plot$method_vec)
kdx <- which(method =="LDpred (hap3)")
method[kdx] <- "LDpred"
kdx <- which(method =="EUR LDpred (hap3)")
method[kdx] <- "EUR LDpred PRS"
kdx <- which(method =="ME-Bayes (hap3)")
method[kdx] <- "ME-Bayes"
kdx <- which(method =="Best EUR PRS")
method[kdx] <- "EUR P+T PRS"
kdx <- which(method =="Best EUR SNP + target coefficients")
method[kdx] <- "SNPs in EUR P+T + target coefficients"
kdx <- which(method =="Best EUR SNP + EB")
method[kdx] <- "SNPs in EUR P+T + EB coefficients"
method
method.fac <- factor(method,
levels = c("P+T",
"LDpred",
"EUR P+T PRS",
"EUR LDpred PRS",
"SNPs in EUR P+T + target coefficients",
"SNPs in EUR P+T + EB coefficients",
"ME-Bayes",
"2DLD",
"2DLD-EB"))
method.fac
LD.clump.result.plot$method_vec <- method.fac
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_color_nejm()+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_nejm()+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getwd()
save(LD.clump.result.plot,file ="data_for_plot.rdata")
setwd("/Users/zhangh24/GoogleDrive/multi_ethnic/result/LD_simulation_new")
load("data_for_plot.rdata")
source("theme_publication.R")
rm(list=ls())
setwd("/Users/zhangh24/Desktop/compare_method_plot")
load("data_for_plot.rdata")
source("theme_publication.R")
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
library(RColorBrewer)
colourCount = length(unique(LD.clump.result$method_vec))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
colourCount = length(unique(LD.clump.result.plot$method_vec))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
method.fac
LD.clump.result.plot$method_vec
getPalette = colorRampPalette(brewer.pal(9, "Set2"))
colourCount = length(unique(LD.clump.result.plot$method_vec))
getPalette = colorRampPalette(brewer.pal(9, "Set2"))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "Set3"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "Set4"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "Set5"))
getPalette = colorRampPalette(brewer.pal(9, "YIOrRd"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
getPalette = colorRampPalette(brewer.pal(9, "Dark2"))
getPalette = colorRampPalette(brewer.pal(9, "Paired"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "Spectral"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "BrBG"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "RdYIBu"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
getPalette = colorRampPalette(brewer.pal(9, "RdYlBu"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
getPalette = colorRampPalette(brewer.pal(9, "Paired"))
p <- ggplot(LD.clump.result.plot,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_bar(aes(fill=method_vec),
stat="identity",
position = position_dodge())+
#geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size for minority group")+
labs(fill = "Method")+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_fill_manual(values = getPalette(colourCount))+
ggtitle("Prediction comparasion (Sample Size for EUR = 100k)")
p
png(file = paste0("./method_compare_result_summary.png"),
width = 13, height = 8, res = 300,units = "in")
p
dev.off()
1-0.017
5*10*3*5*22
2*10*3*5*22

p
sample_size <- factor(sample_size,
levels=paste0("Sample Size = ", c("15000","45000","80000","100000"))
sample_size <- factor(sample_size,
sample_size <- factor(sample_size,
cau_vec <- as.character(LD.clump.result$l_vec)
sample_size <- factor(sample_size,
levels=paste0("Sample Size = ", c("15000","45000","80000","100000")))
sample_size
#genearte plot by varying the p-value threshold
LD.clump.result <- LD.result.list[[2]]
sample_size  <- LD.clump.result$m_vec
sample_size_option <- paste0( "Sample Size = ", c("15000","45000","80000","100000"))
for(m in 1:4){
idx <- which(LD.clump.result$m_vec==m)
sample_size[idx] <- sample_size_option[m]
}
sample_size <- factor(sample_size,
levels=paste0("Sample Size = ", c("15000","45000","80000","100000")))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= -log10(pthres.vec),y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("-log10(P-value)")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(vars(cau_vec),vars(sample_size))+
scale_color_nejm()
p
png(file = paste0("./LD_clumping_result_p_thres.png"),
width = 10, height = 10, res = 300,units = "in")
p
dev.off()
setwd("/Users/zhangh24/GoogleDrive/multi_ethnic/result/LD_simulation_new")
library(ggplot2)
library(ggsci)
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("Training sample size")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(cols=vars(cau_vec))+
scale_color_nejm()
png(file = paste0("./LD_clumping_result_summary.png"),
width = 10, height = 8, res = 300,units = "in")
p
dev.off()
#genearte plot by varying the p-value threshold
LD.clump.result <- LD.result.list[[2]]
sample_size  <- LD.clump.result$m_vec
sample_size_option <- paste0( "Sample Size = ", c("15000","45000","80000","100000"))
for(m in 1:4){
idx <- which(LD.clump.result$m_vec==m)
sample_size[idx] <- sample_size_option[m]
}
sample_size <- factor(sample_size,
levels=paste0("Sample Size = ", c("15000","45000","80000","100000")))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= -log10(pthres.vec),y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("-log10(P-value)")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(vars(cau_vec),vars(sample_size))+
scale_color_nejm()
png(file = paste0("./LD_clumping_result_p_thres.png"),
width = 10, height = 10, res = 300,units = "in")
p
dev.off()
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("Training sample size")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(cols=vars(cau_vec))+
scale_color_nejm()
p
setwd("/Users/zhangh24/GoogleDrive/multi_ethnic/result/LD_simulation_new")
library(ggplot2)
library(ggsci)
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("Training sample size")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(cols=vars(cau_vec))+
scale_color_nejm()
p
setwd("/Users/zhangh24/GoogleDrive/multi_ethnic/result/LD_simulation_new")
library(ggplot2)
library(ggsci)
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("Training sample size")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(cols=vars(cau_vec))+
scale_color_nejm()
png(file = paste0("./LD_clumping_result_summary.png"),
width = 10, height = 8, res = 300,units = "in")
p
dev.off()
#genearte plot by varying the p-value threshold
LD.clump.result <- LD.result.list[[2]]
sample_size  <- LD.clump.result$m_vec
sample_size_option <- paste0( "Sample Size = ", c("15000","45000","80000","100000"))
for(m in 1:4){
idx <- which(LD.clump.result$m_vec==m)
sample_size[idx] <- sample_size_option[m]
}
sample_size <- factor(sample_size,
levels=paste0("Sample Size = ", c("15000","45000","80000","100000")))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= -log10(pthres.vec),y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("-log10(P-value)")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(vars(cau_vec),vars(sample_size))+
scale_color_nejm()
png(file = paste0("./LD_clumping_result_p_thres.png"),
width = 10, height = 10, res = 300,units = "in")
p
dev.off()
png(file = paste0("./LD_clumping_result_p_thres.png"),
width = 15, height = 10, res = 300,units = "in")
p
dev.off()
866/6
670*0.06
37.23*18
paste0
4*3*4
48+1
48*2+1
dim(sum.data)
4*3*4*3(22)
4*3*4*3*22
4*3*4*22
4*3*4*22*3
1056/4
1056/4
4*3*4*22
q = 1
setwd("/Users/zhangh24/GoogleDrive/multi_ethnic/result/LD_simulation_new")
library(ggplot2)
library(ggplot2)
library(ggsci)
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
LD.clump.result
#Best EUR result
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
head(LD.clump.result
)
LD.clump.result <- LD.clump.result[LD.clump.result$eth.vec!="EUR",]
head(LD.clump.result)
method_vec <- rep("P+T",nrow(LD.clump.result))
method_vec
LD.clump.result$method_vec = method_vec
LD.clump.result
load("best_eur_snp_result.rdata")
#Best EUR result
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
LD.clump.result <- LD.clump.result[LD.clump.result$eth.vec!="EUR",]
method_vec <- rep("P+T",nrow(LD.clump.result))
LD.clump.result$method_vec = method_vec
LD.clump.result.PT <- LD.clump.result
LD.clump.result.PT
load("best_eur_snp_result.rdata")
LD.clump.result
#merge the r2 results of AUC
eth <- c("EUR","AFR","AMR","EAS","SAS")
pthres <- c(5E-08,1E-07,5E-07,1E-06,5E-06,1E-05,5E-05,1E-04,1E-03,1E-02,1E-01)
total <- 4*3*4
cur.dir <- "/data/zhangh24/multi_ethnic/result/LD_simulation_new/"
eth.vec <- rep(0,total)
r2.vec <- rep(0,total)
l_vec <- rep(0,total)
load("best_eur_snp_result.rdata")
LD.clump.result
dim(LD.clump.result)
dim(LD.clump.result.PT)
LD.clump.result$method_vec <- "Best EUR PRS"
LD.clump.result <- rbind(LD.clump.result,LD.clump.result.PT)
LD.clump.result
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
cau_vec
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
length(cau_vec)
sample_size <- factor(rep(c("15000","45000","80000","100000"),15*2),
levels=c("15000","45000","80000","100000"))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
#Best EUR result
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15*2),
levels=c("15000","45000","80000","100000"))
sample_size
length(sample_size)
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),4*3*2),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
sample_size
length（sample_size
length(sample_size)
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
LD.clump.result <- LD.clump.result[LD.clump.result$eth.vec!="EUR",]
method_vec <- rep("P+T",nrow(LD.clump.result))
LD.clump.result$method_vec = method_vec
LD.clump.result.PT <- LD.clump.result
load("best_eur_snp_result.rdata")
LD.clump.result$method_vec <- "Best EUR PRS"
LD.clump.result <- rbind(LD.clump.result,LD.clump.result.PT)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
LD.clump.result
head(LD.clump.result)
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_line(aes(color=method_vec))+
geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
guides(color=guide_legend(title="Method"))+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_color_nejm()
theme_Publication <- function(base_size=12) {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, )
+ theme(plot.title = element_text(face = "bold",
size = rel(1.1), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_line(colour="#f0f0f0"),
legend.key = element_rect(colour = NA),
#legend.position = "bottom",
#legend.direction = "horizontal",
#legend.key.size= unit(0.2, "cm"),
#legend.margin = unit(0, "cm"),
legend.title = element_text(face="bold.italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#EF7E3D","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#EF7E3D","chartreuse4","#7fc97f","#004953","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_line(aes(color=method_vec))+
geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
guides(color=guide_legend(title="Method"))+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_color_nejm()
P
p
png(file = paste0("./method_compare_result_summary.png"),
width = 10, height = 8, res = 300,units = "in")
p
dev.off()
setwd("/Users/zhangh24/GoogleDrive/multi_ethnic/result/LD_simulation_new")
library(ggplot2)
library(ggsci)
#standard LD clumping results
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("Training sample size")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(cols=vars(cau_vec))+
scale_color_nejm()
#genearte plot by varying the p-value threshold
LD.clump.result <- LD.result.list[[2]]
sample_size  <- LD.clump.result$m_vec
sample_size_option <- paste0( "Sample Size = ", c("15000","45000","80000","100000"))
for(m in 1:4){
idx <- which(LD.clump.result$m_vec==m)
sample_size[idx] <- sample_size_option[m]
}
sample_size <- factor(sample_size,
levels=paste0("Sample Size = ", c("15000","45000","80000","100000")))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= log10(pthres.vec),y=r2.vec,group=eth.vec))+
geom_line(aes(color=eth.vec))+
geom_point(aes(color=eth.vec))+
theme_Publication()+
ylab("R2")+
xlab("log10(P-value)")+
guides(color=guide_legend(title="Ethnic group"))+
facet_grid(vars(cau_vec),vars(sample_size))+
scale_color_nejm()
png(file = paste0("./LD_clumping_result_p_thres.png"),
width = 15, height = 10, res = 300,units = "in")
p
dev.off()
4*3*4*3
#Best EUR result
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),4*3*2),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
LD.clump.result <- LD.clump.result[LD.clump.result$eth.vec!="EUR",]
method_vec <- rep("P+T",nrow(LD.clump.result))
LD.clump.result$method_vec = method_vec
LD.clump.result.PT <- LD.clump.result
load("best_eur_snp_result.rdata")
head(LD.clump.result)
method_nameupdate <- c("Best EUR PRS","Best EUR SNP + target coefficients","Best EUR SNP + EB")
method <- c("eurcoef","tarcoef","eb")
method_nameupdate <- c("Best EUR PRS","Best EUR SNP + target coefficients","Best EUR SNP + EB")
for(q in 1:length(method)){
idx <- which(LD.clump.result$method_vec==method[q])
LD.clump.result$method_vec[idx] <-   method_nameupdate[q]
}
method_nameupdate <- c("Best EUR PRS","Best EUR SNP + target coefficients","Best EUR SNP + EB")LD.clump.result
LD.clump.result
LD.clump.result <- rbind(LD.clump.result,LD.clump.result.PT)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
p <- ggplot(LD.clump.result,aes(x= sample_size,y=r2.vec,group=method_vec))+
geom_line(aes(color=method_vec))+
geom_point(aes(color=method_vec))+
theme_Publication()+
ylab("R2")+
xlab("Sample Size")+
guides(color=guide_legend(title="Method"))+
facet_grid(vars(cau_vec),vars(eth.vec))+
scale_color_nejm()
p
png(file = paste0("./method_compare_result_summary.png"),
width = 10, height = 8, res = 300,units = "in")
p
dev.off()
png(file = paste0("./method_compare_result_summary.png"),
width = 12, height = 8, res = 300,units = "in")
p
dev.off()
LD.clump.result
LD.clump.result
LD.clump.result.new = LD.clump.result
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
#standard LD clumping results
load("LD.clump.result.rdata")
LD.clump.result <- LD.result.list[[1]]
sample_size <- factor(rep(c("15000","45000","80000","100000"),15),
levels=c("15000","45000","80000","100000"))
cau_vec <- as.character(LD.clump.result$l_vec)
csp <- c(0.01,0.001,0.0005)
for(l in 1:3){
idx <- which(LD.clump.result$l_vec==l)
cau_vec[idx] <- paste0("Causal SNPs Proportion = ",csp[l])
}
cau_vec <- factor(cau_vec,
levels = paste0("Causal SNPs Proportion = ",csp))
LD.clump.result <- cbind(LD.clump.result,sample_size,cau_vec)
LD.clump.result
LD.clump.result.new
LD.clump.result
LD.clump.result.new
